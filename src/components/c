import React, { useState } from 'react';
import Cart from './Cart';
import Constructor from './Constructor';

const App = () => {
    const [cartItems, setCartItems] = useState([]);

    const addToCart = (item) => {
        setCartItems((prevCartItems) => {
            const existingItemIndex = prevCartItems.findIndex(
                (cartItem) =>
                    cartItem.nameproduct === item.nameproduct &&
                    cartItem.type === item.type &&
                    cartItem.colorProduct === item.colorProduct &&
                    cartItem.image === item.image &&
                    cartItem.widthProduct === item.widthProduct
            );

            if (existingItemIndex > -1) {
                const updatedCart = [...prevCartItems];
                updatedCart[existingItemIndex].quantity += 1;
                return updatedCart;
            } else {
                return [...prevCartItems, { ...item, quantity: 1 }];
            }
        });
    };

    const removeFromCart = (index) => {
        setCartItems((prevCartItems) => prevCartItems.filter((_, i) => i !== index));
    };

    const updateQuantity = (index, quantity) => {
        setCartItems((prevCartItems) => {
            const updatedCart = [...prevCartItems];
            if (quantity > 0) {
                updatedCart[index].quantity = quantity;
            } else {
                updatedCart.splice(index, 1);
            }
            return updatedCart;
        });
    };

    return (
        <div>
            <Constructor addToCart={addToCart} />
            <Cart cartItems={cartItems} removeFromCart={removeFromCart} updateQuantity={updateQuantity} />
        </div>
    );
};

export default App;
